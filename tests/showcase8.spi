open corebase
open corecuda
open coreext

open tensorm

inl main() =
    inl in_ : tensor (int * int) float = cupy.random_normal {std=1; mean=0} (32,4) // row map has minimum size restrictions
    inl out = tensor_create in_.dim
    run fun () =>
        open ml.primitives
        row_map (fun config x _ _ => local_softmax config x) in_ out
    console.write_ln (view (fun a,b => {from=0,0; nearTo=4,b}) out) // print only the first 4 rows