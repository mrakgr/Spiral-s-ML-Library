Error trace on line: 92, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Input => ()
          ^
Error trace on line: 93, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
          ^
Error trace on line: 94, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
          ^
Error trace on line: 94, column: 18 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                 ^
Error trace on line: 94, column: 38 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                                     ^
Error trace on line: 87, column: 9 in module: c:\Spiral's ML Library\ml\layers.spi.
        match x with
        ^
Error trace on line: 88, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Weight _ =>
          ^
Error trace on line: 92, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Input => ()
          ^
Error trace on line: 93, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
          ^
Error trace on line: 93, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
              ^
Error trace on line: 93, column: 21 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
                    ^
Error trace on line: 87, column: 9 in module: c:\Spiral's ML Library\ml\layers.spi.
        match x with
        ^
Error trace on line: 88, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Weight _ =>
          ^
Error trace on line: 92, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Input => ()
          ^
Error trace on line: 93, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
          ^
Error trace on line: 94, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
          ^
Error trace on line: 94, column: 18 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                 ^
Error trace on line: 94, column: 38 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                                     ^
Error trace on line: 87, column: 9 in module: c:\Spiral's ML Library\ml\layers.spi.
        match x with
        ^
Error trace on line: 88, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Weight _ =>
          ^
Error trace on line: 92, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Input => ()
          ^
Error trace on line: 93, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
          ^
Error trace on line: 93, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
              ^
Error trace on line: 93, column: 21 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
                    ^
Error trace on line: 87, column: 9 in module: c:\Spiral's ML Library\ml\layers.spi.
        match x with
        ^
Error trace on line: 88, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Weight _ =>
          ^
Error trace on line: 92, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Input => ()
          ^
Error trace on line: 93, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Map(a) => f a
          ^
Error trace on line: 94, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
          ^
Error trace on line: 94, column: 18 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                 ^
Error trace on line: 94, column: 38 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                                     ^
Error trace on line: 94, column: 44 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Matmul(a,b) | Map2(a,b) => f a . f b
                                           ^
Error trace on line: 87, column: 9 in module: c:\Spiral's ML Library\ml\layers.spi.
        match x with
        ^
Error trace on line: 88, column: 11 in module: c:\Spiral's ML Library\ml\layers.spi.
        | Weight _ =>
          ^
Error trace on line: 90, column: 13 in module: c:\Spiral's ML Library\ml\layers.spi.
            inl x : tensor dim t = partitionm.from_partition_offsets base_and_length (hashmap.get h x)
            ^
Error trace on line: 91, column: 13 in module: c:\Spiral's ML Library\ml\layers.spi.
            cupy.copy_to {from=cupy.random_normal{mean=0; std=1} x.dim; to=x}
            ^
Error trace on line: 41, column: 32 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
inl copy_to forall dim float. ({from to} : {from : tensor dim float; to : tensor dim float}) : () =
                               ^
Error trace on line: 42, column: 5 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
    assert (from.dim = to.dim) "The dimensions of the two tensors have to be equal."
    ^
Error trace on line: 43, column: 5 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
    inl contiguous_stride, len = real utils.calculate_stride_len from.dim
    ^
Error trace on line: 43, column: 9 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
    inl contiguous_stride, len = real utils.calculate_stride_len from.dim
        ^
Error trace on line: 44, column: 10 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
    real struct.iter2 (fun (tensor_body from) (tensor_body to) =>
         ^
Error trace on line: 126, column: 5 in module: c:\Spiral's ML Library\corebase\struct.spir.
    f (ar, v)
    ^
Error trace on line: 122, column: 17 in module: c:\Spiral's ML Library\corebase\struct.spir.
    inl rec f = function
                ^
Error trace on line: 123, column: 12 in module: c:\Spiral's ML Library\corebase\struct.spir.
        | (a, b), (va,vb) => f (a, va) . f (b, vb)
           ^
Error trace on line: 124, column: 11 in module: c:\Spiral's ML Library\corebase\struct.spir.
        | {} & ar, {} & v => record_iter (fun {key value} => f (ar key, value)) v
          ^
Error trace on line: 125, column: 11 in module: c:\Spiral's ML Library\corebase\struct.spir.
        | ar,v => set ar v
          ^
Error trace on line: 125, column: 19 in module: c:\Spiral's ML Library\corebase\struct.spir.
        | ar,v => set ar v
                  ^
Error trace on line: 44, column: 48 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
    real struct.iter2 (fun (tensor_body from) (tensor_body to) =>
                                               ^
Error trace on line: 45, column: 9 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
        assert (contiguous_stride = from.stride) "In order for the tensor to be copiable, the stride must be contiguous for the input tensor."
        ^
Error trace on line: 45, column: 17 in module: c:\Spiral's ML Library\corecuda\cupy.spi.
        assert (contiguous_stride = from.stride) "In order for the tensor to be copiable, the stride must be contiguous for the input tensor."
                ^
Cannot apply a forall with a term.