Error trace on line: 23, column: 23 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
                      ^
Error trace on line: 35, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Weight {dim} => dim
              ^
Error trace on line: 36, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Input (exists key. k) => get_dim k
              ^
Error trace on line: 37, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
              ^
Error trace on line: 37, column: 19 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
                  ^
Error trace on line: 37, column: 29 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
                            ^
Error trace on line: 37, column: 38 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
                                     ^
Error trace on line: 21, column: 5 in module: c:\Spiral's ML Library\ml\layers.spi.
    match hashmap.try_get h k with
    ^
Error trace on line: 22, column: 7 in module: c:\Spiral's ML Library\ml\layers.spi.
    | Some v => v
      ^
Error trace on line: 23, column: 7 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
      ^
Error trace on line: 23, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
              ^
Error trace on line: 23, column: 23 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
                      ^
Error trace on line: 35, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Weight {dim} => dim
              ^
Error trace on line: 36, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Input (exists key. k) => get_dim k
              ^
Error trace on line: 37, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
              ^
Error trace on line: 38, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map2(exists a b. _,a,b) =>
              ^
Error trace on line: 42, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Matmul(a,b) =>
              ^
Error trace on line: 42, column: 22 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Matmul(a,b) =>
                     ^
Error trace on line: 43, column: 17 in module: c:\Spiral's ML Library\ml\layers.spi.
                inl (m,k),(k',n) = f a, f b
                ^
Error trace on line: 43, column: 36 in module: c:\Spiral's ML Library\ml\layers.spi.
                inl (m,k),(k',n) = f a, f b
                                   ^
Error trace on line: 21, column: 5 in module: c:\Spiral's ML Library\ml\layers.spi.
    match hashmap.try_get h k with
    ^
Error trace on line: 22, column: 7 in module: c:\Spiral's ML Library\ml\layers.spi.
    | Some v => v
      ^
Error trace on line: 23, column: 7 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
      ^
Error trace on line: 23, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
              ^
Error trace on line: 23, column: 23 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
                      ^
Error trace on line: 35, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Weight {dim} => dim
              ^
Error trace on line: 36, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Input (exists key. k) => get_dim k
              ^
Error trace on line: 37, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
              ^
Error trace on line: 37, column: 19 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
                  ^
Error trace on line: 37, column: 29 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
                            ^
Error trace on line: 37, column: 38 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
                                     ^
Error trace on line: 21, column: 5 in module: c:\Spiral's ML Library\ml\layers.spi.
    match hashmap.try_get h k with
    ^
Error trace on line: 22, column: 7 in module: c:\Spiral's ML Library\ml\layers.spi.
    | Some v => v
      ^
Error trace on line: 23, column: 7 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
      ^
Error trace on line: 23, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
              ^
Error trace on line: 23, column: 23 in module: c:\Spiral's ML Library\ml\layers.spi.
    | None => inl v = f k in hashmap.add h k v . v
                      ^
Error trace on line: 35, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Weight {dim} => dim
              ^
Error trace on line: 36, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Input (exists key. k) => get_dim k
              ^
Error trace on line: 37, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map(exists a. _, a) => f a
              ^
Error trace on line: 38, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Map2(exists a b. _,a,b) =>
              ^
Error trace on line: 42, column: 15 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Matmul(a,b) =>
              ^
Error trace on line: 42, column: 22 in module: c:\Spiral's ML Library\ml\layers.spi.
            | Matmul(a,b) =>
                     ^
Error trace on line: 43, column: 17 in module: c:\Spiral's ML Library\ml\layers.spi.
                inl (m,k),(k',n) = f a, f b
                ^
Error trace on line: 43, column: 22 in module: c:\Spiral's ML Library\ml\layers.spi.
                inl (m,k),(k',n) = f a, f b
                     ^
Error trace on line: 43, column: 28 in module: c:\Spiral's ML Library\ml\layers.spi.
                inl (m,k),(k',n) = f a, f b
                           ^
Error trace on line: 44, column: 17 in module: c:\Spiral's ML Library\ml\layers.spi.
                assert (k = k') "The dimensions of the inner dimensions to the matrix multiplication node have to be equal."
                ^
Error trace on line: 125, column: 50 in module: c:\Spiral's ML Library\corebase\core.spi.
inl assert (c : bool) (msg : string) : () = real assert c msg
                                                 ^
Error trace on line: 265, column: 5 in module: c:\Spiral's ML Library\corebase\real_core.spir.
    if c = false then 
    ^
Error trace on line: 266, column: 9 in module: c:\Spiral's ML Library\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
        ^
Error trace on line: 266, column: 40 in module: c:\Spiral's ML Library\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
                                       ^
The dimensions of the inner dimensions to the matrix multiplication node have to be equal.