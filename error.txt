Error trace on line: 241, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
inl main() = test()
        ^
Error trace on line: 241, column: 14 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
inl main() = test()
             ^
Error trace on line: 47, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
inl test() =
        ^
Error trace on line: 48, column: 5 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
    inl size = {
    ^
Error trace on line: 55, column: 5 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
    inl trace : trace = {
    ^
Error trace on line: 64, column: 5 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
    inl model : model = tensor_create (size.world_id, size.action_id)
    ^
Error trace on line: 65, column: 5 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
    run fun () =>
    ^
Error trace on line: 71, column: 13 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
inl run f = run' {shared_mem = 0} f
            ^
Error trace on line: 32, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    inl blocks_per_grid, threads_per_block = blocks_per_grid(), threads_per_block()
    ^
Error trace on line: 32, column: 9 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    inl blocks_per_grid, threads_per_block = blocks_per_grid(), threads_per_block()
        ^
Error trace on line: 34, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    global "options = []"
    ^
Error trace on line: 36, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    global "options.append('--dopt=on')" // turns on the device optimizations
    ^
Error trace on line: 37, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    global "options.append('--diag-suppress=550,20012,68,39')" // suppresses some warnings
    ^
Error trace on line: 38, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    global "options.append('--restrict')" // assumes all the pointers are restricted
    ^
Error trace on line: 40, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    match threads_per_block with
    ^
Error trace on line: 46, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    inl compiler = NVCC
    ^
Error trace on line: 47, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    match compiler with
    ^
Error trace on line: 53, column: 5 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
    inl kernel_i, vars = join_backend Cuda
    ^
Error trace on line: 54, column: 9 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
        match compiler with
        ^
Error trace on line: 60, column: 9 in module: c:\Spiral_s_ML_Library\corecuda\base.spi.
        f () : ()
        ^
Error trace on line: 65, column: 13 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
    run fun () =>
            ^
Error trace on line: 66, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl thread_id = {thread_id = thread_index()}
        ^
Error trace on line: 67, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl mask config x i j = j < 3
        ^
Error trace on line: 68, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        let get_action (world_id : world_id) : action_prob * action_id =
        ^
Error trace on line: 91, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl calculate_updates (model : model) (trace : trace) (seq_id : seq_id) (reward : list reward) =
        ^
Error trace on line: 150, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl apply_updates (model : model) (trace : trace) (seq_id : seq_id) =
        ^
Error trace on line: 211, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl seq_id = ref (0 : int)
        ^
Error trace on line: 213, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl log_path_prob : _ _ log_path_prob = tensor_create size.player_id
        ^
Error trace on line: 214, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        loop.linear log_path_prob.dim fun i => tensor_set i {sampling=0; policy=0} log_path_prob
        ^
Error trace on line: 216, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        inl push' (world_id, player_id : world_id * player_id) (action_prob, action_id : action_prob * action_id) : () =
        ^
Error trace on line: 230, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        let push (world_id, player_id : world_id * player_id) = push' (world_id,player_id) (get_action world_id)
        ^
Error trace on line: 231, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        push (235, 0)
        ^
Error trace on line: 232, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        push (212, 1)
        ^
Error trace on line: 233, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        push (790, 0)
        ^
Error trace on line: 234, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        push (343, 1)
        ^
Error trace on line: 235, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        push (457, 0)
        ^
Error trace on line: 236, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        push (3447, 1)
        ^
Error trace on line: 238, column: 9 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
        calculate_updates model trace #seq_id [13; -13; 4]
        ^
Error trace on line: 92, column: 13 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
            inl rewards : _ _ reward = tensorm.fromList reward
            ^
Error trace on line: 93, column: 13 in module: c:\Spiral_s_ML_Library\cfr\main.spi.
            assert (rewards.dim = size.player_id) "The rewards have to equal the number of players."
            ^
Error trace on line: 131, column: 50 in module: c:\Spiral_s_ML_Library\corebase\core.spi.
inl assert (c : bool) (msg : string) : () = real assert c msg
                                                 ^
Error trace on line: 267, column: 5 in module: c:\Spiral_s_ML_Library\corebase\real_core.spir.
    if c = false then 
    ^
Error trace on line: 268, column: 9 in module: c:\Spiral_s_ML_Library\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
        ^
Error trace on line: 268, column: 40 in module: c:\Spiral_s_ML_Library\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
                                       ^
The rewards have to equal the number of players.