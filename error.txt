Error trace on line: 276, column: 52 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowReduce(exists a. _,a,out) => g (f a) out
                                                   ^
Error trace on line: 262, column: 9 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        match x with
        ^
Error trace on line: 263, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | Some => x
          ^
Error trace on line: 264, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | None =>
          ^
Error trace on line: 265, column: 13 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            match out with
            ^
Error trace on line: 266, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Some x => f x
              ^
Error trace on line: 266, column: 20 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Some x => f x
                   ^
Error trace on line: 266, column: 25 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Some x => f x
                        ^
Error trace on line: 48, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    match hashmapm.try_get h k with
    ^
Error trace on line: 49, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | Some v => v
      ^
Error trace on line: 50, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
      ^
Error trace on line: 50, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
              ^
Error trace on line: 50, column: 23 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
                      ^
Error trace on line: 274, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 275, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 276, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowReduce(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 277, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMatmul(a,b) => pair a b
              ^
Error trace on line: 278, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Apply(exists a. a,b) => pair a b
              ^
Error trace on line: 278, column: 21 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Apply(exists a. a,b) => pair a b
                    ^
Error trace on line: 278, column: 31 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Apply(exists a. a,b) => pair a b
                              ^
Error trace on line: 278, column: 39 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Apply(exists a. a,b) => pair a b
                                      ^
Error trace on line: 269, column: 9 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        match f a with
        ^
Error trace on line: 269, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        match f a with
              ^
Error trace on line: 48, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    match hashmapm.try_get h k with
    ^
Error trace on line: 49, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | Some v => v
      ^
Error trace on line: 50, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
      ^
Error trace on line: 50, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
              ^
Error trace on line: 50, column: 23 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
                      ^
Error trace on line: 274, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 275, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 276, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowReduce(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 277, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMatmul(a,b) => pair a b
              ^
Error trace on line: 278, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Apply(exists a. a,b) => pair a b
              ^
Error trace on line: 279, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Zip(a,b) => pair a b
              ^
Error trace on line: 280, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Pair(a,b) => pair a b
              ^
Error trace on line: 281, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Weight => None
              ^
Error trace on line: 282, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Input => None
              ^
Error trace on line: 283, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | KeyScalar => None
              ^
Error trace on line: 284, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | KeyTensor((exists key'. _),graph) =>
              ^
Error trace on line: 284, column: 26 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | KeyTensor((exists key'. _),graph) =>
                         ^
Error trace on line: 285, column: 17 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                if (real open real_core in `key `= `key') then // `= operator compares the two types for equality.
                ^
Error trace on line: 286, column: 21 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                    inl recreate forall a t'. (a : tensor a t') : tensor dim input = 
                    ^
Error trace on line: 289, column: 21 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                    Some (graph_tensor_extract (model {m with graph}) {} |> recreate)
                    ^
Error trace on line: 289, column: 27 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                    Some (graph_tensor_extract (model {m with graph}) {} |> recreate)
                          ^
Error trace on line: 57, column: 16 in module: c:\Spiral_s_ML_Library\corebase\core.spi.
inl (|>) a b = b a
               ^
Error trace on line: 287, column: 30 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                        real open real_core in assert (`a `= `dim && `t' `= `input) "The tensor dimension and type in the key node need to equal the target one."
                             ^
Error trace on line: 287, column: 48 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                        real open real_core in assert (`a `= `dim && `t' `= `input) "The tensor dimension and type in the key node need to equal the target one."
                                               ^
Error trace on line: 265, column: 5 in module: c:\Spiral_s_ML_Library\corebase\real_core.spir.
    if c = false then 
    ^
Error trace on line: 266, column: 9 in module: c:\Spiral_s_ML_Library\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
        ^
Error trace on line: 266, column: 40 in module: c:\Spiral_s_ML_Library\corebase\real_core.spir.
        if lit_is c && lit_is msg then error_type msg
                                       ^
The tensor dimension and type in the key node need to equal the target one.