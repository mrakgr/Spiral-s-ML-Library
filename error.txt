    inl x = key_extract model .input : tensor (int * int * int) float
    assert (fst x.dim = blocks_per_grid()) "The first dimension of the input tensor has to equal blocks per grid."
    inl x = x |> apply block_index()
    assert (fst x.dim = threads_per_block()) "The second dimension of the input tensor has to equal threads per block."

    // Sets the input tensor to 0.
    loop.projective threads_in_block(x.dim) fun i =>
        tensor_set i 0 x