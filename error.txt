Error trace on line: 583, column: 9 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
inl main() = test2()
        ^
Error trace on line: 583, column: 14 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
inl main() = test2()
             ^
Error trace on line: 518, column: 10 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
inl test2() =
         ^
Error trace on line: 519, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl m,n : int * int = (1 <<< 4), (1 <<< 8)
    ^
Error trace on line: 519, column: 9 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl m,n : int * int = (1 <<< 4), (1 <<< 8)
        ^
Error trace on line: 522, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl input_identity : _ _ int = cupy.arange{from=0; nearTo=m,n; by=1}
    ^
Error trace on line: 523, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl input : _ _ float = cupy.random_normal{mean=0; std=1} (m,n)
    ^
Error trace on line: 524, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl input_action : _ _ float = cupy.random_uniform m
    ^
Error trace on line: 526, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_reduce = tensor_create 1
    ^
Error trace on line: 527, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_identity = tensor_create (m,n)
    ^
Error trace on line: 528, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_softmax = tensor_create (m,n)
    ^
Error trace on line: 529, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_masked_softmax = tensor_create (m,n)
    ^
Error trace on line: 530, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_softmax_scan = tensor_create (m,n)
    ^
Error trace on line: 531, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_ln = tensor_create (m,n)
    ^
Error trace on line: 532, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_argmax = tensor_create m
    ^
Error trace on line: 533, column: 5 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_sampling = tensor_create m
    ^
Error trace on line: 533, column: 27 in module: c:\Spiral_s_ML_Library\ml\primitives.spi.
    inl output_sampling = tensor_create m
                          ^
Error trace on line: 43, column: 5 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    inl stride, len = real calculate_stride_len dim
    ^
Error trace on line: 43, column: 9 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    inl stride, len = real calculate_stride_len dim
        ^
Error trace on line: 44, column: 5 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    assert_long_length len dim
    ^
Error trace on line: 45, column: 5 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    inl create_body forall t. : tensor_body dim t = tensor_body {
    ^
Error trace on line: 50, column: 5 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    tensor {dim bodies=real infer_map `el create_body}
    ^
Error trace on line: 50, column: 12 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    tensor {dim bodies=real infer_map `el create_body}
           ^
Error trace on line: 50, column: 29 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    tensor {dim bodies=real infer_map `el create_body}
                            ^
Error trace on line: 9, column: 5 in module: c:\Spiral_s_ML_Library\corebase\struct.spir.
    f `el
    ^
Error trace on line: 5, column: 9 in module: c:\Spiral_s_ML_Library\corebase\struct.spir.
        typecase el with
        ^
Error trace on line: 6, column: 22 in module: c:\Spiral_s_ML_Library\corebase\struct.spir.
        | ~a * ~b => f `a, f `b
                     ^
Error trace on line: 5, column: 9 in module: c:\Spiral_s_ML_Library\corebase\struct.spir.
        typecase el with
        ^
Error trace on line: 8, column: 16 in module: c:\Spiral_s_ML_Library\corebase\struct.spir.
        | _ => g `el
               ^
Error trace on line: 45, column: 53 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    inl create_body forall t. : tensor_body dim t = tensor_body {
                                                    ^
Error trace on line: 45, column: 65 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
    inl create_body forall t. : tensor_body dim t = tensor_body {
                                                                ^
Error trace on line: 46, column: 17 in module: c:\Spiral_s_ML_Library\corebase\tensorm\tensor_main.spi.
        array = create len
                ^
Error trace on line: 47, column: 37 in module: c:\Spiral_s_ML_Library\corebase\base.spi.
instance create array = fun size => array !!!!ArrayCreate(`el,size)
                                    ^
Only stack allocated primitive types (i8,i16,i32,i64 and u8,u16,u32,u64 and f32,f64 and bool) are allowed in CuPy arrays.