Error trace on line: 344, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 345, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 346, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowReduce(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 347, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowMapReduce(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 348, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMatmul(a,b) => pair a b
              ^
Error trace on line: 348, column: 27 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMatmul(a,b) => pair a b
                          ^
Error trace on line: 348, column: 35 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMatmul(a,b) => pair a b
                                  ^
Error trace on line: 339, column: 9 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        match f a with
        ^
Error trace on line: 339, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        match f a with
              ^
Error trace on line: 66, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    match hashmapm.try_get h k with
    ^
Error trace on line: 67, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | Some v => v
      ^
Error trace on line: 68, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
      ^
Error trace on line: 68, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
              ^
Error trace on line: 68, column: 23 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => inl v = f k in hashmapm.add h k v . v
                      ^
Error trace on line: 344, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 345, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowMap(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 346, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowReduce(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 347, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockRowMapReduce(exists a. _,a,out) => g (f a) out
              ^
Error trace on line: 348, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | BlockMatmul(a,b) => pair a b
              ^
Error trace on line: 349, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Apply(exists a. a,b) => pair a b
              ^
Error trace on line: 350, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Zip(a,b) => pair a b
              ^
Error trace on line: 351, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Pair(a,b) => pair a b
              ^
Error trace on line: 352, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Weight => None
              ^
Error trace on line: 353, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Input => None
              ^
Error trace on line: 354, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | KeyScalar => None
              ^
Error trace on line: 355, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | KeyGraph((exists key'. _),graph) =>
              ^
Error trace on line: 355, column: 25 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | KeyGraph((exists key'. _),graph) =>
                        ^
Error trace on line: 356, column: 17 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                if (real open real_core in `key `= `key') then // `= operator compares the two types for equality.
                ^
Error trace on line: 357, column: 21 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                    inl g = graph_extract (model {m with graph}) {}
                    ^
Error trace on line: 357, column: 29 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                    inl g = graph_extract (model {m with graph}) {}
                            ^
Error trace on line: 325, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    loop graph
    ^
Error trace on line: 299, column: 9 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        match graph with
        ^
Error trace on line: 300, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | BlockMap(exists a. _,_,Some out) => loop out
          ^
Error trace on line: 301, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | BlockRowMap(exists a. _,_,Some out) => loop out
          ^
Error trace on line: 302, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | BlockRowReduce(exists a. _,_,Some out) => loop out
          ^
Error trace on line: 303, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | BlockRowMapReduce(exists a. _,_,Some out) => loop out
          ^
Error trace on line: 304, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | Zip(a,b) => zip (loop a) (loop b)
          ^
Error trace on line: 305, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | Pair(a,b) => loop a, loop b
          ^
Error trace on line: 306, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | Apply(exists a. a,b) => apply (loop b) (loop a)
          ^
Error trace on line: 307, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | KeyScalar(exists k. k) => real 
          ^
Error trace on line: 311, column: 11 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
        | KeyGraph(_,x) => loop x
          ^
Error trace on line: 313, column: 13 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            match hashmapm.try_get (fst param.offset) graph with
            ^
Error trace on line: 314, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | Some x => partitionm.from_partition_offsets param.array x
              ^
Error trace on line: 315, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
            | None =>
              ^
Error trace on line: 316, column: 17 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                match hashmapm.try_get (fst output.offset) graph with
                ^
Error trace on line: 316, column: 23 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
                match hashmapm.try_get (fst output.offset) graph with
                      ^
Error trace on line: 21, column: 5 in module: c:\Spiral_s_ML_Library\corebase\compile_time\hashmapm.spi.
    match !!!!HashMapTryGet(h,k) with
    ^
Error trace on line: 22, column: 7 in module: c:\Spiral_s_ML_Library\corebase\compile_time\hashmapm.spi.
    | .null => None `value
      ^
Error trace on line: 23, column: 7 in module: c:\Spiral_s_ML_Library\corebase\compile_time\hashmapm.spi.
    | v => Some `value v
      ^
Error trace on line: 23, column: 12 in module: c:\Spiral_s_ML_Library\corebase\compile_time\hashmapm.spi.
    | v => Some `value v
           ^
For key Some, The type of the value does not match the union case.
Got: partition_offsets (tensor (i32 * i32 * i32) f32)
Expected: partition_of (tensor (i32 * i32 * i32) f32)