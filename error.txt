Error trace on line: 19, column: 39 in module: c:\Spiral_s_ML_Library\corebase\loop.spi.
    while' (fun () => cond state) fun () => _set state (body state)
                                      ^
Error trace on line: 19, column: 45 in module: c:\Spiral_s_ML_Library\corebase\loop.spi.
    while' (fun () => cond state) fun () => _set state (body state)
                                            ^
Error trace on line: 19, column: 57 in module: c:\Spiral_s_ML_Library\corebase\loop.spi.
    while' (fun () => cond state) fun () => _set state (body state)
                                                        ^
Error trace on line: 2, column: 16 in module: c:\Spiral_s_ML_Library\corebase\optionm.spi.
inl bind f x = match x with Some a => f a | None => None
               ^
Error trace on line: 2, column: 29 in module: c:\Spiral_s_ML_Library\corebase\optionm.spi.
inl bind f x = match x with Some a => f a | None => None
                            ^
Error trace on line: 2, column: 34 in module: c:\Spiral_s_ML_Library\corebase\optionm.spi.
inl bind f x = match x with Some a => f a | None => None
                                 ^
Error trace on line: 2, column: 39 in module: c:\Spiral_s_ML_Library\corebase\optionm.spi.
inl bind f x = match x with Some a => f a | None => None
                                      ^
Error trace on line: 108, column: 9 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
        match node with
        ^
Error trace on line: 109, column: 11 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
        | TerminalFold table =>
          ^
Error trace on line: 117, column: 11 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
        | TerminalCall table =>
          ^
Error trace on line: 130, column: 11 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
        | Round table => 
          ^
Error trace on line: 130, column: 17 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
        | Round table => 
                ^
Error trace on line: 131, column: 13 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
            match index #state.pl_type table.player_turn with
            ^
Error trace on line: 132, column: 15 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
            | Computer =>
              ^
Error trace on line: 134, column: 17 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
                inl model = ml.cfr_models.from_model_data model.game_graph() neural.model_data
                ^
Error trace on line: 135, column: 17 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
                inl data = table, refm.to_local state.messages
                ^
Error trace on line: 136, column: 17 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
                console.write_ln "Running the GPU model."
                ^
Error trace on line: 137, column: 17 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
                inl action = ml.cfr_models.run model (Some data) |> action_conv table
                ^
Error trace on line: 137, column: 30 in module: c:\Spiral_s_ML_Library\game\leduc\play.spi.
                inl action = ml.cfr_models.run model (Some data) |> action_conv table
                             ^
Error trace on line: 20, column: 9 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
        ~(data : option inp) = join
        ^
Error trace on line: 20, column: 11 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
        ~(data : option inp) = join
          ^
Error trace on line: 22, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    barrier_cta_sync 0
    ^
Error trace on line: 25, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl ensemble,block,thread = (key_extract model .output_world_id : tensor d3 uint).dim
    ^
Error trace on line: 25, column: 9 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl ensemble,block,thread = (key_extract model .output_world_id : tensor d3 uint).dim
        ^
Error trace on line: 25, column: 18 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl ensemble,block,thread = (key_extract model .output_world_id : tensor d3 uint).dim
                 ^
Error trace on line: 26, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl () = // Assert that all the dimensions are right.
    ^
Error trace on line: 26, column: 9 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl () = // Assert that all the dimensions are right.
        ^
Error trace on line: 33, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl ls = create_layer_state()
    ^
Error trace on line: 36, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl x = (key_extract model .input : tensor d3 float)
    ^
Error trace on line: 37, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    assert (block = fst x.dim) "The first dimension of the input tensor has to equal the number of blocks per grid."
    ^
Error trace on line: 38, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl x = x |> apply block_index()
    ^
Error trace on line: 39, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    assert (thread = fst x.dim) "The second dimension of the input tensor has to equal number threads per block."
    ^
Error trace on line: 42, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl ls = create_layer_state()
    ^
Error trace on line: 45, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    loop.projective threads_in_block(x.dim) fun i =>
    ^
Error trace on line: 48, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    barrier_cta_sync 0
    ^
Error trace on line: 53, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    data |> optionm.iter fun data =>
    ^
Error trace on line: 58, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    barrier_cta_sync 0
    ^
Error trace on line: 61, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl ensemble_id : int = 
    ^
Error trace on line: 66, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    graph_run_device model ls {ensemble=ensemble_id}
    ^
Error trace on line: 68, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    barrier_cta_sync 0
    ^
Error trace on line: 71, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl world_id =
    ^
Error trace on line: 76, column: 5 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl cfr_model = (key_extract model .cfr_model : cfr.model)
    ^
Error trace on line: 76, column: 22 in module: c:\Spiral_s_ML_Library\ml\cfr_models.spi.
    inl cfr_model = (key_extract model .cfr_model : cfr.model)
                     ^
Error trace on line: 329, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    assert (snd output.array = snd output.offset) "The sizes of both the pointer storing the data for the graph, and the graph size must be the same."
    ^
Error trace on line: 330, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    inl h = hashmapm.create()
    ^
Error trace on line: 360, column: 5 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    match f graph with
    ^
Error trace on line: 361, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | Some x => x
      ^
Error trace on line: 362, column: 7 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => error_type "Cannot find the input tensor with the given key."
      ^
Error trace on line: 362, column: 15 in module: c:\Spiral_s_ML_Library\ml\layers.spi.
    | None => error_type "Cannot find the input tensor with the given key."
              ^
Error trace on line: 149, column: 38 in module: c:\Spiral_s_ML_Library\corebase\core.spi.
inl error_type (msg : string) = real error_type msg
                                     ^
Cannot find the input tensor with the given key.